# =============================================================================
# Required Configuration
# =============================================================================
# These values MUST be set before starting.
# Run `./scripts/setup.sh` to generate all secrets automatically,
# or use the generate-secrets.sh commands below to generate them manually.

# Initial Setup
ON_PREM_EMAIL=root@currents.local

# Generate with: ./scripts/generate-secrets.sh token 32
ON_PREM_PASSWORD=

# SMTP information
SMTP_HOST=localhost
SMTP_USER=test
SMTP_PASS=test

# Authentication
# Generate with: ./scripts/generate-secrets.sh token 64
BETTER_AUTH_SECRET=
# Generate with: ./scripts/generate-secrets.sh token 64
API_SECRET=

# Object Storage (additional settings)
# RUSTFS (optional, set only if using the included rustfs)
# Generate with: ./scripts/generate-secrets.sh token 32
RUSTFS_SECRET_KEY=

# MongoDB
# Generate with: ./scripts/generate-secrets.sh token 32
# Or set to your existing password
MONGODB_PASSWORD=

# ClickHouse
# Default password only needed if using the included clickhouse
# Generate with: ./scripts/generate-secrets.sh token 32
CLICKHOUSE_DEFAULT_PASSWORD=
# Password for the currents-user for clickhouse
# Generate with: ./scripts/generate-secrets.sh token 32
# Or provide your existing password
CLICKHOUSE_CURRENTS_PASSWORD=

# GitLab Integration (base64-encoded RSA private key)
# Generate with:
#   ./scripts/generate-secrets.sh key .gitlab-key.pem
#   base64 < .gitlab-key.pem | tr -d '\n'
GITLAB_STATE_SECRET=

# =============================================================================
# Frequently Used Configuration
# =============================================================================

# Application URLs
APP_BASE_URL=http://localhost:4000
CURRENTS_RECORD_API_URL=http://localhost:1234

# Additional Email / SMTP
SMTP_PORT=587
SMTP_SECURE=false
AUTOMATED_REPORTS_EMAIL_FROM="Currents Report <report@example.com>"

## RustFS (optional)
RUSTFS_ACCESS_KEY=rustfs-access-key

# Object Storage (endpoint for external access)
FILE_STORAGE_ENDPOINT="http://localhost:9000"
FILE_STORAGE_BUCKET="currents"
FILE_STORAGE_ACCESS_KEY_ID=${RUSTFS_ACCESS_KEY}
FILE_STORAGE_SECRET_ACCESS_KEY=${RUSTFS_SECRET_KEY}
# FILE_STORAGE_REGION=us-east-1

# ClickHouse
CLICKHOUSE_URL=http://clickhouse:8123
CLICKHOUSE_USERNAME=currents
# CLICKHOUSE_ACCESS_TOKEN=

# MongoDB
MONGODB_USERNAME=currents-user
MONGODB_DATABASE=currents
MONGODB_URI=mongodb://${MONGODB_USERNAME}:${MONGODB_PASSWORD}@mongodb:27017/${MONGODB_DATABASE}?authSource=admin&replicaSet=rs0

# Domain configuration for Traefik routing
# TRAEFIK_DOMAIN=example.com
# TRAEFIK_API_SUBDOMAIN=currents-app
# TRAEFIK_DIRECTOR_SUBDOMAIN=currents-record
# TRAEFIK_STORAGE_SUBDOMAIN=currents-storage
# TRAEFIK_ENABLE_STORAGE=false

# =============================================================================
# Other Configuration
# =============================================================================
# Less commonly changed settings with sensible defaults.

# Derived URLs (built from base URLs - usually don't need to change)
API_URL=${APP_BASE_URL}/v1
DASHBOARD_URL=${APP_BASE_URL}
BETTER_AUTH_URL=${APP_BASE_URL}
AUTOMATED_REPORTS_CURRENTS_DASHBOARD_HOSTNAME=${APP_BASE_URL}
GITLAB_REDIRECT_URL=${APP_BASE_URL}/integrations/gitlab/callback


# Redis (default points to redis service in compose network)
REDIS_URI=redis://redis:6379
REDIS_URI_SLAVE=redis://redis:6379

# Object Storage (addition configuration)
FILE_STORAGE_INTERNAL_ENDPOINT="http://host.docker.internal:9000"
# FILE_STORAGE_FORCE_PATH_STYLE=true  # Set automatically when using RustFS profile

# Email (additional settings)
AUTOMATED_REPORTS_EMAIL_BCC=

# Observability (Coralogix)
# CORALOGIX_API_ENDPOINT=
# CORALOGIX_API_KEY=
# CORALOGIX_APP_NAME="customer-name"

# =============================================================================
# Docker Compose Configuration
# =============================================================================
# These variables configure docker-compose behavior (DC_ prefix = not passed to containers)

# Currents application images
# DC_CURRENTS_IMAGE_REPOSITORY=513558712013.dkr.ecr.us-east-1.amazonaws.com/currents/on-prem/
# DC_CURRENTS_IMAGE_TAG=staging

# Infrastructure service images (full image reference)
# DC_MONGODB_IMAGE=mongo:8.2.3
# DC_REDIS_IMAGE=redis/redis-stack-server:7.4.0-v8
# DC_CLICKHOUSE_IMAGE=clickhouse/clickhouse-server:25.8
# DC_RUSTFS_IMAGE=rustfs/rustfs:1.0.0-alpha.79
# DC_AWS_CLI_IMAGE=amazon/aws-cli:latest

# Port Configuration
# Currents services default to all interfaces, databases default to localhost only
# DC_DIRECTOR_PORT=1234                    # Director API (default: all interfaces)
# DC_API_PORT=4000                         # Dashboard/API (default: all interfaces)
# DC_MONGODB_PORT=127.0.0.1:27017          # MongoDB (default: localhost only)
# DC_REDIS_PORT=127.0.0.1:6379             # Redis (default: localhost only)
# DC_CLICKHOUSE_HTTP_PORT=127.0.0.1:8123   # ClickHouse HTTP (default: localhost only)
# DC_CLICKHOUSE_TCP_PORT=127.0.0.1:9123    # ClickHouse TCP (default: localhost only)
# DC_RUSTFS_S3_PORT=9000                   # RustFS S3 API (default: all interfaces)
# DC_RUSTFS_CONSOLE_PORT=9001              # RustFS Console (default: all interfaces)

# Data Volume Configuration
# By default, data is stored in ./data/<service> (auto-created)
# DC_REDIS_VOLUME=./data/redis
# DC_MONGODB_VOLUME=./data/mongodb
# DC_CLICKHOUSE_VOLUME=./data/clickhouse
# DC_RUSTFS_VOLUME=./data/rustfs
# DC_SCHEDULER_STARTUP_VOLUME=./data/startup

# =============================================================================
# Traefik TLS Termination (Optional Profile)
# =============================================================================
# Enable with: docker compose --profile tls up
# Certificate handling:
#   - Default: Place wildcard.crt and wildcard.key in data/traefik/certs/
#   - Auto-generated: Set TRAEFIK_GENERATE_TEMP_CERTS=true

# DC_TRAEFIK_IMAGE=traefik:v3.3
# DC_TRAEFIK_HTTP_PORT=80
# DC_TRAEFIK_HTTPS_PORT=443
# DC_TRAEFIK_CERTS_DIR=./data/traefik/certs
# DC_TRAEFIK_CONFIG_DIR=./data/traefik/config
# DC_TRAEFIK_DYNAMIC_CONFIG_PATH=/etc/traefik/dynamic.yml
# TRAEFIK_GENERATE_TEMP_CERTS=false
